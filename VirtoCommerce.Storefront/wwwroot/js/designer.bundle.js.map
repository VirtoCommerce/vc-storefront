{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./handlers/base.handler.ts","webpack:///./service-locator.ts","webpack:///./root/events.bus.ts","webpack:///./environment.ts","webpack:///./helpers.ts","webpack:///./main.ts","webpack:///./dnd.interactor.ts","webpack:///./preview.interactor.ts","webpack:///./services/http.service.ts","webpack:///./events.dispatcher.ts","webpack:///./renderer.ts","webpack:///./handlers.factory.ts","webpack:///./handlers/index.ts","webpack:///./handlers/add.handler.ts","webpack:///./block.view-model.ts","webpack:///./handlers/clone.handler.ts","webpack:///./handlers/hide.handler.ts","webpack:///./handlers/hover.handler.ts","webpack:///./handlers/preview.handler.ts","webpack:///./handlers/remove.handler.ts","webpack:///./handlers/select.handler.ts","webpack:///./handlers/show.handler.ts","webpack:///./handlers/swap.handler.ts","webpack:///./handlers/update.handler.ts","webpack:///./handlers/reload.handler.ts","webpack:///./handlers/page.handler.ts","webpack:///./app.ts","webpack:///./services/messages.service.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","block_view_model_1","service_locator_1","BaseHandler","renderer","ServiceLocator","getRenderer","[object Object]","msg","list","vm","this","getViewModel","content","id","createViewModel","executeInternal","model","getHttp","post","isPreview","result","BlockViewModel","assign","generateId","source","element","htmlString","selected","hidden","internalId","find","x","forEach","map","item","index","filter","splice","remove","dnd_interactor_1","preview_interactor_1","events_bus_1","http_service_1","events_dispatcher_1","renderer_1","handlers_factory_1","environment_1","app_1","messages_service_1","_container","document","getElementById","_app","App","getDispatcher","_interactor","PreviewInteractor","getDndInteractor","_dnd","DndInteractor","getList","_eventBus","EventsBus","_http","HttpService","Environment","RenderBlockApiUrl","_messages","MessagesService","DesignerUrl","_renderer","Renderer","_factory","HandlersFactory","_dispatcher","EventsDispatcher","getFactory","getMessages","subscribers","type","args","handler","push","indexOf","Current","measureElement","target","target_width","offsetWidth","target_height","offsetHeight","rect","gleft","gtop","moonwalk","_parent","top","offsetTop","left","offsetLeft","height","width","offsetParent","addEventListener","console","log","window","createApp","run","event","preventDefault","helpers_1","container","listAccessor","delta","startMouseY","oldStyle","onDragStarted","onDragFinished","draggedModel","onSwapBlocks","first","second","placeholder","createElement","style","backgroundColor","$event","isPressed","dragStarted","drag","startDrag","releaseDrag","pageY","elementRect","targetRect","minY","maxY","rects","Math","abs","replaceChild","body","appendChild","saveStyle","styleDraggedBlock","mouseY","max","min","to","findIndex","from","middleY","removeChild","beforeElement","children","insertBefore","currentIndex","newIndex","publish","restoreStyles","postion","position","border","opacity","overflow","dnd","borderWidth","hoveredViewModel","selectedViewModel","inactive","createHoverElement","createSelectElement","hideHoverElement","hideSelectElement","hoverElement","display","placeElementHover","selectElement","targetPosition","innerHeight","scroll","behavior","createShadowElement","onLeave","select","onSelect","mouseDown","selectBlock","zIndex","endpoint","Promise","resolve","reject","xhr","XMLHttpRequest","open","setRequestHeader","getToken","send","JSON","stringify","onload","evt","responseText","trim","postTo","token","parts","cookie","split","xsrf","length","part","startsWith","substr","factory","messages","handleMessage","subscribe","_source","swapBlock","data","handleEvent","blockHover","swapBlocks","interactor","getPreviewInteractor","append","hover","deselect","scrollTo","div","innerHTML","firstChild","userSelect","onHover","handlers","AddHandler","UpdateHandler","CloneHandler","HideHandler","ShowHandler","RemoveHandler","PreviewHandler","SelectHandler","SwapHandler","ReloadHandler","PageHandler","HoverHandler","__export","base_handler_1","clearPreview","reloadBlock","then","add","eventsDispatcher","unlightBlock","highlightBlock","deselectAll","destination","clone","insert","setTimeout","super","execute","parentElement","update","location","reload","blocks","all","html","renderComplete","dispatcher","reloadResources","suffix","URLSearchParams","search","Date","getTime","nodes","getElementsByTagName","generateLinkNode","url","setAttribute","styleSheet","href","origin","endsWith","newlink","parent","parentNode","parentOrigin","message","postMessage"],"mappings":"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","file":"designer.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","import { Renderer } from './../renderer';\r\nimport { BaseMessage, MessageContent } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\nimport { MessageHandler } from \"./message.handler\";\r\nimport { ServiceLocator } from '../service-locator';\r\n\r\nexport abstract class BaseHandler implements MessageHandler {\r\n\r\n    abstract readonly key: string;\r\n    protected get renderer(): Renderer {\r\n        return ServiceLocator.getRenderer();\r\n    }\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        let vm = this.getViewModel(msg.content.id, list);\r\n        if (!vm) {\r\n            vm = this.createViewModel(msg.content);\r\n        }\r\n        this.executeInternal(msg, list, vm);\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) { }\r\n\r\n    protected reloadBlock(model: any): Promise<string> {\r\n        return ServiceLocator.getHttp().post(model);\r\n    }\r\n\r\n    protected generateId(id: number) {\r\n        if (id) {\r\n            return `instance${id}`;\r\n        }\r\n        return 'preview-instance';\r\n    }\r\n\r\n    protected createViewModel(content: MessageContent, isPreview = false): BlockViewModel {\r\n        const result = new BlockViewModel();\r\n        Object.assign(result, {\r\n            id: this.generateId(content.id),\r\n            source: content,\r\n            element: null,\r\n            isPreview: isPreview,\r\n            htmlString: null,\r\n            selected: false,\r\n            hidden: !!content.hidden\r\n        });\r\n        return result;\r\n    }\r\n\r\n    protected getViewModel(id: number, list: BlockViewModel[]): BlockViewModel {\r\n        const internalId = this.generateId(id);\r\n        return list.find(x => x.id === internalId);\r\n    }\r\n\r\n    protected deselectAll(list: BlockViewModel[]) {\r\n        list.forEach(x => x.selected = false);\r\n    }\r\n\r\n    protected clearPreview(list: BlockViewModel[]) {\r\n        const listToRemove = list.map((item, index) => <any>{ item, index }).filter(x => x.item.isPreview);\r\n        listToRemove.forEach(x => {\r\n            list.splice(x.index, 1);\r\n            x.item.element.remove();\r\n        });\r\n    }\r\n}","import { DndInteractor } from './dnd.interactor';\r\nimport { PreviewInteractor } from './preview.interactor';\r\nimport { EventsBus } from './root/events.bus';\r\nimport { HttpService } from './services/http.service';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { Renderer } from './renderer';\r\nimport { HandlersFactory } from './handlers.factory';\r\nimport { Environment } from './environment';\r\nimport { App } from './app';\r\nimport { MessagesService } from './services/messages.service';\r\n\r\nexport class ServiceLocator {\r\n\r\n    private static _app;\r\n    private static _container;\r\n    private static _http;\r\n    private static _messages;\r\n    private static _renderer;\r\n    private static _factory;\r\n    private static _dispatcher;\r\n    private static _eventBus;\r\n    private static _interactor;\r\n    private static _dnd;\r\n\r\n    static createApp(): App {\r\n        this._container = document.getElementById(\"designer-preview\");\r\n        return this._app || (this._app = new App(this.getDispatcher()));\r\n    }\r\n\r\n    static getPreviewInteractor(): PreviewInteractor {\r\n        if (!this._interactor) {\r\n            this._interactor = new PreviewInteractor(this.getDndInteractor());\r\n        }\r\n        return this._interactor;\r\n    }\r\n\r\n    static getDndInteractor(): DndInteractor {\r\n        return this._dnd || (this._dnd = new DndInteractor(this._container, () => this._app.getList()));\r\n    }\r\n\r\n    static getEventBus(): EventsBus {\r\n        return this._eventBus || (this._eventBus = new EventsBus());\r\n    }\r\n\r\n    static getHttp(): HttpService {\r\n        return this._http || (this._http = new HttpService(Environment.RenderBlockApiUrl));\r\n    }\r\n\r\n    static getMessages(): MessagesService {\r\n        return this._messages || (this._messages = new MessagesService(Environment.DesignerUrl));\r\n    }\r\n\r\n    static getRenderer(): Renderer {\r\n        return this._renderer || (this._renderer = new Renderer(this._container));\r\n    }\r\n\r\n    static getFactory(): HandlersFactory {\r\n        return this._factory || (this._factory = new HandlersFactory());\r\n    }\r\n\r\n    static getDispatcher(): EventsDispatcher {\r\n        return this._dispatcher || (this._dispatcher = new EventsDispatcher(this.getFactory(), this.getMessages()));\r\n    }\r\n}","export class EventsBus {\r\n\r\n    static Current = new EventsBus();\r\n\r\n    private subscribers = {};\r\n\r\n    publish(type: string, args: any, source: any) {\r\n        if (this.subscribers[type]) {\r\n            this.subscribers[type].forEach(handler => {\r\n                handler(args, source);\r\n            });\r\n        }\r\n    }\r\n\r\n    subscribe(type: string, handler: (args: any, source: any) => {}): () => void {\r\n        if (!this.subscribers[type]) {\r\n            this.subscribers[type] = [];\r\n        }\r\n        this.subscribers[type].push(handler);\r\n        return () => {\r\n            const index = this.subscribers[type].indexOf(handler);\r\n            if (index !== -1) {\r\n                this.subscribers[type].splice(index, 1);\r\n            }\r\n        };\r\n    }\r\n}\r\n","export const Environment = {\r\n    RenderBlockApiUrl: '/designer-preview/block',\r\n    DesignerUrl: ''\r\n}\r\n","export function  measureElement(element): { top?: number, left?: number, height?: number, width?: number } {\r\n    const target = element;\r\n    const target_width = target.offsetWidth;\r\n    const target_height = target.offsetHeight;\r\n    let rect = {};\r\n    let gleft = 0;\r\n    let gtop = 0;\r\n\r\n    var moonwalk = function (_parent) {\r\n        if (!!_parent) {\r\n            gleft += _parent.offsetLeft;\r\n            gtop += _parent.offsetTop;\r\n            moonwalk(_parent.offsetParent);\r\n        } else {\r\n            return rect = {\r\n                top: target.offsetTop + gtop,\r\n                left: target.offsetLeft + gleft,\r\n                height: target_height,\r\n                width: target_width\r\n            };\r\n        }\r\n    };\r\n    moonwalk(target.offsetParent);\r\n    return rect;\r\n}","import { Environment } from './environment';\r\nimport { ServiceLocator } from './service-locator';\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    console.log('run preview window')\r\n    Environment.DesignerUrl = window['__designer_preview__'];\r\n    const app = ServiceLocator.createApp();\r\n    app.run();\r\n});\r\n\r\nwindow.addEventListener('click', (event) => {\r\n    event.preventDefault();\r\n});\r\n","import { BlockViewModel } from './block.view-model';\r\nimport { measureElement } from './helpers';\r\nimport { EventsBus } from './root/events.bus';\r\n\r\nexport class DndInteractor {\r\n\r\n    private delta = 10;\r\n\r\n    private placeholder: HTMLElement;\r\n\r\n    private isPressed: boolean;\r\n    private dragStarted: boolean;\r\n    private model: BlockViewModel;\r\n\r\n    private startMouseY: number = null;\r\n    private elementRect: any;\r\n    private list: BlockViewModel[];\r\n    private rects: any[];\r\n    private oldStyle: any = {};\r\n    private minY: number;\r\n    private maxY: number;\r\n\r\n    onDragStarted = () => { };\r\n    onDragFinished = (draggedModel: BlockViewModel) => { };\r\n    onSwapBlocks = (first, second) => { };\r\n\r\n    constructor(private container: HTMLElement, private listAccessor: () => []) {\r\n        this.placeholder = document.createElement('div');\r\n        this.placeholder.style.backgroundColor = '#eeeeee';\r\n        window.addEventListener('mousemove', ($event) => {\r\n            if (this.isPressed) {\r\n                if (!this.dragStarted) {\r\n                    this.startDrag($event);\r\n                } else {\r\n                    this.drag($event);\r\n                }\r\n            }\r\n        });\r\n        window.addEventListener('mouseup', ($event) => {\r\n            if (this.dragStarted) {\r\n                this.releaseDrag();\r\n            }\r\n            this.isPressed = false;\r\n        });\r\n    }\r\n\r\n    mouseDown($event: MouseEvent, vm: BlockViewModel) {\r\n        this.isPressed = true;\r\n        this.model = vm;\r\n        this.startMouseY = $event.pageY;\r\n        this.elementRect = measureElement(vm.element);\r\n        this.placeholder.style.height = this.elementRect.height + 'px';\r\n        this.list = this.listAccessor();\r\n        const targetRect = measureElement(this.container);\r\n        this.minY = targetRect.top;\r\n        this.maxY = targetRect.top + targetRect.height;\r\n        this.rects = this.list.map(x => measureElement(x.element));\r\n    }\r\n\r\n    private startDrag($event: MouseEvent) {\r\n        if (Math.abs($event.pageY - this.startMouseY) >= this.delta) {\r\n            this.dragStarted = true;\r\n            this.onDragStarted();\r\n            this.container.replaceChild(this.placeholder, this.model.element);\r\n            document.body.appendChild(this.model.element);\r\n            this.saveStyle();\r\n            this.styleDraggedBlock();\r\n            this.container.style.height = measureElement(this.container).height + 'px';\r\n        }\r\n    }\r\n\r\n    private drag(event: MouseEvent) {\r\n        const mouseY = Math.max(Math.min(event.pageY, this.maxY), this.minY)\r\n        this.model.element.style.top = mouseY - this.startMouseY + this.elementRect.top + 'px';\r\n        const to = this.rects.findIndex(x => x !== this.model && x.top < mouseY && (x.top + x.height) > mouseY);\r\n        const from = this.list.indexOf(this.model);\r\n        if (from === -1 || to === -1 || from === to) return;\r\n        const middleY = (this.rects[to].top + this.rects[to].height / 2);\r\n        const needSwap = (from > to && mouseY <= middleY) || (from <= to && mouseY > middleY);\r\n        if (needSwap) {\r\n            console.log(from, to, mouseY, this.rects[to]);\r\n            this.container.removeChild(this.placeholder);\r\n            const beforeElement = this.container.children.item(to);\r\n            this.container.insertBefore(this.placeholder, beforeElement);\r\n            const msg = { content: { id: this.model.id, currentIndex: from, newIndex: to } };\r\n            EventsBus.Current.publish('dnd.swap-blocks', msg, this);\r\n            console.log('swapped');\r\n            // debugger;\r\n        }\r\n        // get new coords\r\n        // search element under mouse\r\n        // if above a half of element change up (send message to designer)\r\n        // if below a half of element change down (send message to designer)\r\n    }\r\n\r\n    private releaseDrag() {\r\n        // if drag happens\r\n        // replace placeholder with source element\r\n        // restore height of other elements\r\n        // 'select' should be occured automatically\r\n\r\n        if (this.dragStarted) {\r\n            console.log('release drag', this.model);\r\n            document.body.removeChild(this.model.element);\r\n            this.restoreStyles();\r\n            this.container.replaceChild(this.model.element, this.placeholder);\r\n            this.elementRect = null;\r\n            this.startMouseY = null;\r\n            this.onDragFinished(this.model);\r\n            this.oldStyle = {};\r\n            this.container.style.height = '';\r\n        }\r\n\r\n        this.dragStarted = false;\r\n        this.isPressed = false;\r\n        this.model = null;\r\n    }\r\n\r\n    private saveStyle() {\r\n        this.oldStyle.left = this.model.element.style.left;\r\n        this.oldStyle.top = this.model.element.style.top;\r\n        this.oldStyle.width = this.model.element.style.width;\r\n        this.oldStyle.height = this.model.element.style.height;\r\n        this.oldStyle.postion = this.model.element.style.position;\r\n        this.oldStyle.backgroundColor = this.model.element.style.backgroundColor;\r\n        this.oldStyle.border = this.model.element.style.border;\r\n        this.oldStyle.opacity = this.model.element.style.opacity;\r\n    }\r\n\r\n    private restoreStyles() {\r\n        this.model.element.style.position = this.oldStyle.position || 'static';\r\n        this.model.element.style.left = this.oldStyle.left;\r\n        this.model.element.style.top = this.oldStyle.top;\r\n        this.model.element.style.width = this.oldStyle.width;\r\n        this.model.element.style.height = this.oldStyle.height;\r\n        this.model.element.style.backgroundColor = this.oldStyle.backgroundColor;\r\n        this.model.element.style.border = this.oldStyle.border;\r\n        this.model.element.style.opacity = this.oldStyle.opacity;\r\n    }\r\n\r\n    private styleDraggedBlock() {\r\n        this.model.element.style.left = this.elementRect.left + 'px';\r\n        this.model.element.style.top = this.elementRect.top + 'px';\r\n        this.model.element.style.width = this.elementRect.width + 'px';\r\n        this.model.element.style.height = this.elementRect.height + 'px';\r\n        this.model.element.style.overflow = 'hidden';\r\n        this.model.element.style.position = 'absolute';\r\n        this.model.element.style.backgroundColor = '#fefefe';\r\n        this.model.element.style.border = '3px solid #33ada9';\r\n        this.model.element.style.opacity = \"0.5\";\r\n    }\r\n}\r\n","import { EventsBus } from './root/events.bus';\r\nimport { DndInteractor } from './dnd.interactor';\r\nimport { BlockViewModel } from './models';\r\nimport { ServiceLocator } from './service-locator';\r\nimport { measureElement } from './helpers';\r\n\r\nexport class PreviewInteractor {\r\n    private readonly borderWidth: number = 3;\r\n\r\n    private hoverElement: HTMLElement;\r\n    private selectElement: HTMLElement;\r\n\r\n    private hoveredViewModel: BlockViewModel = null;\r\n    private selectedViewModel: BlockViewModel = null;\r\n\r\n    private inactive = false; // use with dnd\r\n\r\n    constructor(private dnd: DndInteractor) {\r\n        this.createHoverElement();\r\n        this.createSelectElement();\r\n        this.dnd.onDragStarted = () => {\r\n            this.inactive = true;\r\n            this.hideHoverElement();\r\n            this.hideSelectElement();\r\n        };\r\n        this.dnd.onDragFinished = () => {\r\n            this.inactive = false;\r\n        }\r\n    }\r\n\r\n    hover(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        if (vm == null || this.selectedViewModel == vm) {\r\n            this.hideHoverElement();\r\n        } else {\r\n            this.hoveredViewModel = vm;\r\n            this.hoverElement.style.display = 'block';\r\n            this.placeElementHover(vm.element, this.hoverElement);\r\n        }\r\n    }\r\n\r\n    select(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        this.selectedViewModel = vm;\r\n        this.selectElement.style.display = 'block';\r\n        this.placeElementHover(vm.element, this.selectElement);\r\n    }\r\n\r\n    deselect() {\r\n        this.hideSelectElement();\r\n    }\r\n\r\n    scrollTo(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        const rect = measureElement(vm.element);\r\n        const targetPosition = rect.top - window.innerHeight / 10;\r\n        window.scroll({\r\n            top: targetPosition,\r\n            behavior: 'smooth'\r\n        });\r\n    }\r\n\r\n    private hideSelectElement() {\r\n        this.selectedViewModel = null;\r\n        this.selectElement.style.display = 'none';\r\n    }\r\n\r\n    private hideHoverElement() {\r\n        this.hoveredViewModel = null;\r\n        this.hoverElement.style.display = 'none';\r\n    }\r\n\r\n    private createHoverElement(): HTMLElement {\r\n        const result = this.createShadowElement();\r\n        result.style.border = `${this.borderWidth}px dotted #33ada9`;\r\n        result.addEventListener('mouseleave', () => {\r\n            if (this.hoveredViewModel != null) {\r\n                this.hoveredViewModel.onLeave();\r\n            }\r\n            this.hideHoverElement();\r\n        });\r\n        result.addEventListener('click', (event) => {\r\n            this.select(this.hoveredViewModel);\r\n            this.hoveredViewModel.onSelect();\r\n            this.hideHoverElement();\r\n        });\r\n        result.addEventListener('mousedown', (event: MouseEvent) => {\r\n            this.dnd.mouseDown(event, this.hoveredViewModel);\r\n        });\r\n        this.hoverElement = result;\r\n        return result;\r\n    }\r\n\r\n    private createSelectElement(): HTMLElement {\r\n        const result = this.createShadowElement();\r\n        result.style.border = `${this.borderWidth}px solid #33ada9`;\r\n        result.addEventListener('click', (event) => {\r\n            const dispatcher = ServiceLocator.getDispatcher();\r\n            dispatcher.selectBlock(null);\r\n        });\r\n        result.addEventListener('mousedown', (event: MouseEvent) => {\r\n            this.dnd.mouseDown(event, this.selectedViewModel);\r\n        });\r\n        this.selectElement = result;\r\n        return result;\r\n    }\r\n\r\n    private createShadowElement(): HTMLElement {\r\n        const result = document.createElement('div');\r\n        result.style.position = 'absolute';\r\n        result.style.display = 'none';\r\n        result.style.zIndex = '10000';\r\n        document.body.appendChild(result);\r\n        return result;\r\n    }\r\n\r\n    private placeElementHover(source: HTMLElement, target: HTMLElement) {\r\n        if (!source) {\r\n            return;\r\n        }\r\n        const rect = measureElement(source);\r\n        const doubleWidth = this.borderWidth * 2;\r\n        const delta = 0;\r\n        target.style.top = (rect.top + delta) + 'px';\r\n        target.style.left = (rect.left + delta) + 'px';\r\n        target.style.height = (rect.height - 2 * delta) + 'px';\r\n        target.style.width = (rect.width - 2 * delta) + 'px';\r\n        target.style.display = 'block';\r\n    }\r\n}\r\n","export class HttpService {\r\n\r\n    private token: string;\r\n\r\n    constructor(private endpoint: string) { }\r\n\r\n    get() {\r\n\r\n    }\r\n\r\n    postTo(endpoint: string, model: any) {\r\n        // https://gist.github.com/codecorsair/e14ec90cee91fa8f56054afaa0a39f13\r\n        return new Promise<string>((resolve, reject) => {\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.open('post', endpoint);\r\n\r\n            xhr.setRequestHeader('Accept', 'application/json, text/javascript, text/plain')\r\n            xhr.setRequestHeader('Cache-Control', 'no-cache');\r\n            xhr.setRequestHeader('Content-Type', 'application/json');\r\n            xhr.setRequestHeader('X-XSRF-TOKEN', this.getToken());\r\n            xhr.send(JSON.stringify(model));\r\n            // xhr.timeout = timeout;\r\n            xhr.onload = evt => {\r\n                // const result = {\r\n                //     ok: xhr.status >= 200 && xhr.status < 300,\r\n                //     status: xhr.status,\r\n                //     statusText: xhr.statusText,\r\n                //     headers: xhr.getAllResponseHeaders(),\r\n                //     data: xhr.responseText\r\n                // };\r\n                resolve(xhr.responseText.trim());\r\n                // this.blocks.push(model); or replace\r\n            };\r\n            // xhr.onerror = evt => {\r\n            //   resolve(errorResponse(xhr, 'Failed to make request.'));\r\n            // };\r\n            // xhr.ontimeout = evt => {\r\n            //   resolve(errorResponse(xhr, 'Request took longer than expected.'));\r\n            // };\r\n        });\r\n    }\r\n\r\n    post(model: any): Promise<string> {\r\n        return this.postTo(this.endpoint, model);\r\n    }\r\n\r\n    private getToken(): string {\r\n        if (!this.token){\r\n            var all = document.cookie;\r\n            var parts = all.split(';');\r\n            var xsrf = null;\r\n            for (var i = 0; i < parts.length; i++) {\r\n                var part = parts[i];\r\n                if (part.startsWith(' XSRF-TOKEN') || part.startsWith('XSRF-TOKEN')){\r\n                    xsrf = part.substr(part.indexOf('XSRF-TOKEN=') + 11)\r\n                    break;\r\n                }\r\n            }\r\n            this.token = xsrf;\r\n        }\r\n        return this.token;\r\n    }\r\n\r\n/*\r\n\r\n\r\n\r\n\r\n*/\r\n\r\n\r\n\r\n\r\n}","import { MessagesService } from './services/messages.service';\r\nimport { HandlersFactory } from \"./handlers.factory\";\r\nimport { MessageHandler } from \"./handlers\";\r\nimport { BaseMessage, BlockViewModel } from \"./models\";\r\nimport { EventsBus } from './root/events.bus';\r\n\r\nexport class EventsDispatcher {\r\n    handleMessage: (handler: MessageHandler, msg: BaseMessage) => void = () => {};\r\n\r\n    constructor(private factory: HandlersFactory, private messages: MessagesService) {\r\n        EventsBus.Current.subscribe('dnd.swap-blocks', (args, _source) => {\r\n            this.handleMessage(this.factory.get('swap'), args);\r\n            this.swapBlock(args);\r\n            return null;\r\n        });\r\n    }\r\n\r\n    run() {\r\n        window.addEventListener('message', (event: MessageEvent) => {\r\n            if (event.data) {\r\n                this.handleEvent(event.data)\r\n            }\r\n        });\r\n    }\r\n\r\n    selectBlock(vm: BlockViewModel) {\r\n        if (!!vm && vm.source) {\r\n            this.handleEvent({ type: 'select', content: vm.source });\r\n            this.messages.selectBlock(vm.source);\r\n            vm.selected = false;\r\n        } else {\r\n            this.handleEvent({ type: 'select', content: { id: 0 } });\r\n            this.messages.selectBlock(null);\r\n            if (!!vm) {\r\n                vm.selected = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    highlightBlock(vm: BlockViewModel) {\r\n        this.messages.blockHover(vm.source);\r\n    }\r\n\r\n    unlightBlock() {\r\n        this.messages.blockHover({ id: 0 });\r\n    }\r\n\r\n    swapBlock(args: any) {\r\n        this.messages.swapBlocks(args);\r\n    }\r\n\r\n    private handleEvent(msg: BaseMessage) {\r\n        const handler = this.factory.get(msg.type);\r\n        if (handler) {\r\n            this.handleMessage(handler, msg);\r\n        }\r\n    }\r\n}\r\n","import { EventsBus } from './root/events.bus';\r\nimport { ServiceLocator } from './service-locator';\r\nimport { BlockViewModel } from './block.view-model';\r\nimport { PreviewInteractor } from './preview.interactor';\r\nimport { DndInteractor } from './dnd.interactor';\r\n\r\nexport class Renderer {\r\n\r\n    private interactor: PreviewInteractor;\r\n\r\n    constructor(public container: HTMLElement) {\r\n        this.interactor = ServiceLocator.getPreviewInteractor();\r\n    }\r\n\r\n    add(vm: BlockViewModel) {\r\n        vm.element = this.createElement(vm);\r\n        this.container.append(vm.element);\r\n        if (vm.hidden) {\r\n            vm.element.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    update(vm: BlockViewModel) {\r\n        const element = vm.element;\r\n        if (!element) {\r\n            return;\r\n        }\r\n        vm.element = this.createElement(vm);\r\n        this.container.replaceChild(vm.element, element);\r\n        this.interactor.select(vm);\r\n        this.hover(vm);\r\n    }\r\n\r\n    insert(vm: BlockViewModel, index: number) {\r\n        vm.element = this.createElement(vm);\r\n        const beforeElement = this.container.children.item(index);\r\n        this.container.insertBefore(vm.element, beforeElement);\r\n        if (vm.hidden) {\r\n            vm.element.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    select(vm: BlockViewModel = null) {\r\n        if (vm === null || vm.hidden || !vm.selected) {\r\n            this.interactor.deselect();\r\n        } else {\r\n            this.interactor.select(vm)\r\n        }\r\n    }\r\n\r\n    scrollTo(vm: BlockViewModel) {\r\n        if (vm && vm.element && !vm.hidden) {\r\n            this.interactor.scrollTo(vm)\r\n        }\r\n    }\r\n\r\n    hover(vm: BlockViewModel = null) {\r\n        if (vm === null || vm.hidden || vm.selected) {\r\n            this.interactor.hover(null);\r\n        } else {\r\n            this.interactor.hover(vm);\r\n        }\r\n    }\r\n\r\n    private createElement(vm: BlockViewModel) {\r\n        const div = document.createElement('div');\r\n        div.innerHTML = `<div>${vm.htmlString}</div>`;\r\n        const result = <HTMLElement>div.firstChild;\r\n        result.style.userSelect = 'none';\r\n        if (!vm.isPreview) {\r\n            result.addEventListener('mouseover', ($event: MouseEvent) => {\r\n                this.interactor.hover(vm);\r\n                vm.onHover();\r\n            });\r\n            result.addEventListener('click', () => vm.onSelect());\r\n        }\r\n        return result;\r\n    }\r\n}\r\n","import * as handlers from \"./handlers\";\r\n\r\nexport class HandlersFactory {\r\n    private static handlers: handlers.MessageHandler[] = [\r\n        new handlers.AddHandler(),\r\n        new handlers.UpdateHandler(),\r\n        new handlers.CloneHandler(),\r\n        new handlers.HideHandler(),\r\n        new handlers.ShowHandler(),\r\n        new handlers.RemoveHandler(),\r\n        new handlers.PreviewHandler(),\r\n        new handlers.SelectHandler(),\r\n        new handlers.SwapHandler(),\r\n        new handlers.ReloadHandler(),\r\n        new handlers.PageHandler(),\r\n        new handlers.HoverHandler()\r\n    ];\r\n\r\n    get(key: string): handlers.MessageHandler {\r\n        return HandlersFactory.handlers.find(x => x.key == key);\r\n    }\r\n}\r\n","export * from './message.handler';\r\n\r\nexport * from './add.handler';\r\nexport * from './clone.handler';\r\nexport * from './hide.handler';\r\nexport * from './hover.handler';\r\nexport * from './preview.handler';\r\nexport * from './remove.handler';\r\nexport * from './select.handler';\r\nexport * from './show.handler';\r\nexport * from './swap.handler';\r\nexport * from './update.handler';\r\n\r\nexport * from './reload.handler';\r\nexport * from './page.handler';\r\n","import { ServiceLocator } from './../service-locator';\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\nimport { BaseHandler } from \"./base.handler\";\r\n\r\nexport class AddHandler extends BaseHandler {\r\n    readonly key = 'add';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        this.clearPreview(list);\r\n        list.push(vm);\r\n        vm.selected = true;\r\n        this.reloadBlock(vm.source).then(result => {\r\n            vm.htmlString = result;\r\n            this.renderer.add(vm);\r\n            this.renderer.select(vm);\r\n        });\r\n    }\r\n}\r\n","import { ServiceLocator } from './service-locator';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { MessageContent } from './models';\r\n\r\nexport class BlockViewModel {\r\n    id: string;\r\n    source: MessageContent;\r\n    element: HTMLElement;\r\n    htmlString: string;\r\n    selected: boolean; // is this field really necessary?\r\n    hidden: boolean;\r\n    isPreview: boolean;\r\n\r\n    onSelect: () => void = () => {\r\n        this.eventsDispatcher.selectBlock(this);\r\n    };\r\n    onLeave: () => void = () => {\r\n        this.eventsDispatcher.unlightBlock();\r\n    };\r\n    onHover: () => void = () => {\r\n        this.eventsDispatcher.highlightBlock(this);\r\n    };\r\n\r\n    private get eventsDispatcher(): EventsDispatcher {\r\n        return ServiceLocator.getDispatcher();\r\n    }\r\n}\r\n","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class CloneHandler extends BaseHandler {\r\n    readonly key = 'clone';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        const source = this.getViewModel(msg.content.source, list);\r\n\r\n        const model = { ...source.source, id: msg.content.destination };\r\n        const clone = this.createViewModel(model);\r\n        clone.htmlString = source.htmlString;\r\n        clone.hidden = source.hidden;\r\n        clone.selected = true;\r\n\r\n        const index = list.indexOf(source);\r\n        list.splice(index + 1, 0, clone);\r\n        this.renderer.insert(clone, index + 1);\r\n        this.renderer.select(clone);\r\n        setTimeout(() => {\r\n            this.renderer.scrollTo(clone);\r\n        }, 300);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class HideHandler extends BaseHandler {\r\n    readonly key = 'hide';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.hidden = true;\r\n        vm.element.style.display = 'none';\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class HoverHandler extends BaseHandler {\r\n    readonly key = 'hover';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        const content = msg.content;\r\n        if (!content.id) {\r\n            this.renderer.hover();\r\n        } else {\r\n            super.execute(msg, list);\r\n        }\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        this.renderer.hover(vm);\r\n    }\r\n}\r\n","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class PreviewHandler extends BaseHandler {\r\n    readonly key = 'preview';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.clearPreview(list);\r\n        if (!!msg.content) {\r\n            const vm = this.createViewModel(msg.content, true);\r\n            list.push(vm);\r\n            this.reloadBlock(vm.source).then(result => {\r\n                vm.htmlString = result;\r\n                this.renderer.add(vm);\r\n                this.renderer.scrollTo(vm);\r\n            });\r\n        }\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class RemoveHandler extends BaseHandler {\r\n    readonly key = 'remove';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        const index = list.indexOf(vm);\r\n        list.splice(index, 1);\r\n        vm.element.remove();\r\n        this.renderer.select();\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class SelectHandler extends BaseHandler {\r\n    readonly key = 'select';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        this.clearPreview(list);\r\n        const content = msg.content;\r\n        if (content.id === 0) {\r\n            this.renderer.select();\r\n        } else {\r\n            super.execute(msg, list);\r\n        }\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.selected = true;\r\n        this.renderer.select(vm);\r\n        this.renderer.scrollTo(vm);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class ShowHandler extends BaseHandler {\r\n    readonly key = 'show';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.hidden = false;\r\n        vm.element.style.display = 'block';\r\n        this.renderer.scrollTo(vm);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class SwapHandler extends BaseHandler {\r\n    readonly key = 'swap';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        const vm = list[msg.content.currentIndex];\r\n        list.splice(msg.content.currentIndex, 1);\r\n        list.splice(msg.content.newIndex, 0, vm);\r\n        if (list[msg.content.currentIndex].element.parentElement === list[msg.content.newIndex].element.parentElement) {\r\n            vm.element.remove();\r\n            this.renderer.insert(vm, msg.content.newIndex);\r\n        }\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class UpdateHandler extends BaseHandler {\r\n    readonly key = 'update';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.source = msg.content;\r\n        this.reloadBlock(vm.source).then((result: string) => {\r\n            vm.htmlString = result;\r\n            this.renderer.update(vm);\r\n            this.renderer.select(vm);\r\n            // var $: any = window['jQuery'];\r\n            // $(\".carousel-block\").carousel();\r\n        });\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class ReloadHandler extends BaseHandler {\r\n    readonly key = 'reload';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        document.location.reload();\r\n    }\r\n}","import { ServiceLocator } from './../service-locator';\r\nimport { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class PageHandler extends BaseHandler {\r\n    readonly key = 'page';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        console.log(msg);\r\n        const blocks = msg.content.blocks;\r\n        blocks.forEach(x => {\r\n            const vm = this.createViewModel(x);\r\n            list.push(vm);\r\n        });\r\n        Promise.all(list.map(x => {\r\n            const promise = this.reloadBlock(x.source).then(html => {\r\n                x.htmlString = html;\r\n                return html;\r\n            });\r\n            return promise;\r\n        })).then(() => {\r\n            list.forEach(x => {\r\n                this.renderer.add(x);\r\n            });\r\n            // var $: any = window['jQuery'];\r\n            // $(\".carousel-block\").carousel();\r\n            ServiceLocator.getMessages().renderComplete();\r\n        });\r\n    }\r\n}","import { ServiceLocator } from './service-locator';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { BlockViewModel } from './block.view-model';\r\n\r\nexport class App {\r\n    private list: BlockViewModel[] = [];\r\n\r\n    constructor(private dispatcher: EventsDispatcher) { }\r\n\r\n    run() {\r\n        this.reloadResources();\r\n        this.dispatcher.handleMessage =\r\n            (handler, msg) => {\r\n                handler.execute(msg, this.list);\r\n            };\r\n        this.dispatcher.run();\r\n        // ServiceLocator.getMessages().ping();\r\n    }\r\n\r\n    public getList(): BlockViewModel[] {\r\n        return this.list;\r\n    }\r\n\r\n    private reloadResources() {\r\n        var urlParams = new URLSearchParams(window.location.search);\r\n        var prefix = urlParams.get('preview_mode');\r\n        var suffix = \"?preview_mode=\" + prefix + \"&v=\" + (new Date().getTime());\r\n\r\n        var nodes = document.getElementsByTagName(\"link\");\r\n\r\n        function generateLinkNode(url) {\r\n            var result = document.createElement(\"link\");\r\n            result.setAttribute(\"rel\", \"stylesheet\");\r\n            result.setAttribute(\"type\", \"text/css\");\r\n            result.setAttribute(\"href\", url);\r\n            return result;\r\n        }\r\n\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            var styleSheet = nodes[i];\r\n            if (styleSheet.href && styleSheet.href.startsWith(document.location.origin) && styleSheet.href.endsWith(\".css\")) {\r\n                var url = styleSheet.href + suffix;\r\n                var newlink = generateLinkNode(url);\r\n                const parent = styleSheet.parentNode;\r\n                if (!!parent) {\r\n                    parent.replaceChild(newlink, styleSheet);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { MessageContent } from '../models';\r\n\r\nexport class MessagesService {\r\n\r\n    constructor(private parentOrigin: string) { }\r\n\r\n    renderComplete() {\r\n        this.send('render-complete', null);\r\n    }\r\n\r\n    blockHover(model) {\r\n        this.send('hover', { id: model.id });\r\n    }\r\n\r\n    swapBlocks(args) {\r\n        this.send('swap', { type: 'swap', ...args });\r\n    }\r\n\r\n    selectBlock(model: MessageContent) {\r\n        this.send('select', model ? { id: model.id } : null);\r\n    }\r\n\r\n    ping() {\r\n        this.send('ping', null);\r\n    }\r\n\r\n    private send(message: string, model) {\r\n        const msg = { type: message, ...model };\r\n        console.log('send to designer', msg);\r\n        window.parent.postMessage(msg, this.parentOrigin);\r\n    }\r\n}"],"sourceRoot":""}