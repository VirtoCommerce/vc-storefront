{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app.ts","webpack:///./block.view-model.ts","webpack:///./dnd.interactor.ts","webpack:///./environment.ts","webpack:///./events.dispatcher.ts","webpack:///./handlers.factory.ts","webpack:///./handlers/add.handler.ts","webpack:///./handlers/base.handler.ts","webpack:///./handlers/clone.handler.ts","webpack:///./handlers/hide.handler.ts","webpack:///./handlers/hover.handler.ts","webpack:///./handlers/index.ts","webpack:///./handlers/page.handler.ts","webpack:///./handlers/preview.handler.ts","webpack:///./handlers/reload.handler.ts","webpack:///./handlers/remove.handler.ts","webpack:///./handlers/select.handler.ts","webpack:///./handlers/show.handler.ts","webpack:///./handlers/swap.handler.ts","webpack:///./handlers/update.handler.ts","webpack:///./helpers.ts","webpack:///./main.ts","webpack:///./preview.interactor.ts","webpack:///./renderer.ts","webpack:///./root/events.bus.ts","webpack:///./service-locator.ts","webpack:///./services/http.service.ts","webpack:///./services/messages.service.ts"],"names":[],"mappings":"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","file":"designer.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.ts\");\n","import { ServiceLocator } from './service-locator';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { BlockViewModel } from './block.view-model';\r\n\r\nexport class App {\r\n    private list: BlockViewModel[] = [];\r\n\r\n    constructor(private dispatcher: EventsDispatcher) { }\r\n\r\n    run() {\r\n        this.reloadResources();\r\n        this.dispatcher.handleMessage =\r\n            (handler, msg) => {\r\n                handler.execute(msg, this.list);\r\n            };\r\n        this.dispatcher.run();\r\n        // ServiceLocator.getMessages().ping();\r\n    }\r\n\r\n    public getList(): BlockViewModel[] {\r\n        return this.list;\r\n    }\r\n\r\n    private reloadResources() {\r\n        var urlParams = new URLSearchParams(window.location.search);\r\n        var prefix = urlParams.get('preview_mode');\r\n        var suffix = \"?preview_mode=\" + prefix + \"&v=\" + (new Date().getTime());\r\n\r\n        var nodes = document.getElementsByTagName(\"link\");\r\n\r\n        function generateLinkNode(url) {\r\n            var result = document.createElement(\"link\");\r\n            result.setAttribute(\"rel\", \"stylesheet\");\r\n            result.setAttribute(\"type\", \"text/css\");\r\n            result.setAttribute(\"href\", url);\r\n            return result;\r\n        }\r\n\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            var styleSheet = nodes[i];\r\n            if (styleSheet.href && styleSheet.href.startsWith(document.location.origin) && styleSheet.href.endsWith(\".css\")) {\r\n                var url = styleSheet.href + suffix;\r\n                var newlink = generateLinkNode(url);\r\n                const parent = styleSheet.parentNode;\r\n                if (!!parent) {\r\n                    parent.replaceChild(newlink, styleSheet);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","import { ServiceLocator } from './service-locator';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { MessageContent } from './models';\r\n\r\nexport class BlockViewModel {\r\n    id: string;\r\n    source: MessageContent;\r\n    element: HTMLElement;\r\n    htmlString: string;\r\n    selected: boolean; // is this field really necessary?\r\n    hidden: boolean;\r\n    isPreview: boolean;\r\n\r\n    onSelect: () => void = () => {\r\n        this.eventsDispatcher.selectBlock(this);\r\n    };\r\n    onLeave: () => void = () => {\r\n        this.eventsDispatcher.unlightBlock();\r\n    };\r\n    onHover: () => void = () => {\r\n        this.eventsDispatcher.highlightBlock(this);\r\n    };\r\n\r\n    private get eventsDispatcher(): EventsDispatcher {\r\n        return ServiceLocator.getDispatcher();\r\n    }\r\n}\r\n","import { BlockViewModel } from './block.view-model';\r\nimport { measureElement } from './helpers';\r\nimport { EventsBus } from './root/events.bus';\r\n\r\nexport class DndInteractor {\r\n\r\n    private delta = 10;\r\n\r\n    private placeholder: HTMLElement;\r\n\r\n    private isPressed: boolean;\r\n    private dragStarted: boolean;\r\n    private model: BlockViewModel;\r\n\r\n    private startMouseY: number = null;\r\n    private elementRect: any;\r\n    private list: BlockViewModel[];\r\n    private rects: any[];\r\n    private oldStyle: any = {};\r\n    private minY: number;\r\n    private maxY: number;\r\n\r\n    onDragStarted = () => { };\r\n    onDragFinished = (draggedModel: BlockViewModel) => { };\r\n    onSwapBlocks = (first, second) => { };\r\n\r\n    constructor(private container: HTMLElement, private listAccessor: () => []) {\r\n        this.placeholder = document.createElement('div');\r\n        this.placeholder.style.backgroundColor = '#eeeeee';\r\n        window.addEventListener('mousemove', ($event) => {\r\n            if (this.isPressed) {\r\n                if (!this.dragStarted) {\r\n                    this.startDrag($event);\r\n                } else {\r\n                    this.drag($event);\r\n                }\r\n            }\r\n        });\r\n        window.addEventListener('mouseup', ($event) => {\r\n            if (this.dragStarted) {\r\n                this.releaseDrag();\r\n            }\r\n            this.isPressed = false;\r\n        });\r\n    }\r\n\r\n    mouseDown($event: MouseEvent, vm: BlockViewModel) {\r\n        this.isPressed = true;\r\n        this.model = vm;\r\n        this.startMouseY = $event.pageY;\r\n        this.elementRect = measureElement(vm.element);\r\n        this.placeholder.style.height = this.elementRect.height + 'px';\r\n        this.list = this.listAccessor();\r\n        const targetRect = measureElement(this.container);\r\n        this.minY = targetRect.top;\r\n        this.maxY = targetRect.top + targetRect.height;\r\n        this.rects = this.list.map(x => measureElement(x.element));\r\n    }\r\n\r\n    private startDrag($event: MouseEvent) {\r\n        if (Math.abs($event.pageY - this.startMouseY) >= this.delta) {\r\n            this.dragStarted = true;\r\n            this.onDragStarted();\r\n            this.container.replaceChild(this.placeholder, this.model.element);\r\n            document.body.appendChild(this.model.element);\r\n            this.saveStyle();\r\n            this.styleDraggedBlock();\r\n            this.container.style.height = measureElement(this.container).height + 'px';\r\n        }\r\n    }\r\n\r\n    private drag(event: MouseEvent) {\r\n        const mouseY = Math.max(Math.min(event.pageY, this.maxY), this.minY)\r\n        this.model.element.style.top = mouseY - this.startMouseY + this.elementRect.top + 'px';\r\n        const to = this.rects.findIndex(x => x !== this.model && x.top < mouseY && (x.top + x.height) > mouseY);\r\n        const from = this.list.indexOf(this.model);\r\n        if (from === -1 || to === -1 || from === to) return;\r\n        const middleY = (this.rects[to].top + this.rects[to].height / 2);\r\n        const needSwap = (from > to && mouseY <= middleY) || (from <= to && mouseY > middleY);\r\n        if (needSwap) {\r\n            console.log(from, to, mouseY, this.rects[to]);\r\n            this.container.removeChild(this.placeholder);\r\n            const beforeElement = this.container.children.item(to);\r\n            this.container.insertBefore(this.placeholder, beforeElement);\r\n            const msg = { content: { id: this.model.id, currentIndex: from, newIndex: to } };\r\n            EventsBus.Current.publish('dnd.swap-blocks', msg, this);\r\n            console.log('swapped');\r\n            // debugger;\r\n        }\r\n        // get new coords\r\n        // search element under mouse\r\n        // if above a half of element change up (send message to designer)\r\n        // if below a half of element change down (send message to designer)\r\n    }\r\n\r\n    private releaseDrag() {\r\n        // if drag happens\r\n        // replace placeholder with source element\r\n        // restore height of other elements\r\n        // 'select' should be occured automatically\r\n\r\n        if (this.dragStarted) {\r\n            console.log('release drag', this.model);\r\n            document.body.removeChild(this.model.element);\r\n            this.restoreStyles();\r\n            this.container.replaceChild(this.model.element, this.placeholder);\r\n            this.elementRect = null;\r\n            this.startMouseY = null;\r\n            this.onDragFinished(this.model);\r\n            this.oldStyle = {};\r\n            this.container.style.height = '';\r\n        }\r\n\r\n        this.dragStarted = false;\r\n        this.isPressed = false;\r\n        this.model = null;\r\n    }\r\n\r\n    private saveStyle() {\r\n        this.oldStyle.left = this.model.element.style.left;\r\n        this.oldStyle.top = this.model.element.style.top;\r\n        this.oldStyle.width = this.model.element.style.width;\r\n        this.oldStyle.height = this.model.element.style.height;\r\n        this.oldStyle.postion = this.model.element.style.position;\r\n        this.oldStyle.backgroundColor = this.model.element.style.backgroundColor;\r\n        this.oldStyle.border = this.model.element.style.border;\r\n        this.oldStyle.opacity = this.model.element.style.opacity;\r\n    }\r\n\r\n    private restoreStyles() {\r\n        this.model.element.style.position = this.oldStyle.position || 'static';\r\n        this.model.element.style.left = this.oldStyle.left;\r\n        this.model.element.style.top = this.oldStyle.top;\r\n        this.model.element.style.width = this.oldStyle.width;\r\n        this.model.element.style.height = this.oldStyle.height;\r\n        this.model.element.style.backgroundColor = this.oldStyle.backgroundColor;\r\n        this.model.element.style.border = this.oldStyle.border;\r\n        this.model.element.style.opacity = this.oldStyle.opacity;\r\n    }\r\n\r\n    private styleDraggedBlock() {\r\n        this.model.element.style.left = this.elementRect.left + 'px';\r\n        this.model.element.style.top = this.elementRect.top + 'px';\r\n        this.model.element.style.width = this.elementRect.width + 'px';\r\n        this.model.element.style.height = this.elementRect.height + 'px';\r\n        this.model.element.style.overflow = 'hidden';\r\n        this.model.element.style.position = 'absolute';\r\n        this.model.element.style.backgroundColor = '#fefefe';\r\n        this.model.element.style.border = '3px solid #33ada9';\r\n        this.model.element.style.opacity = \"0.5\";\r\n    }\r\n}\r\n","export const Environment = {\r\n    RenderBlockApiUrl: '/designer-preview/block',\r\n    DesignerUrl: ''\r\n}\r\n","import { MessagesService } from './services/messages.service';\r\nimport { HandlersFactory } from \"./handlers.factory\";\r\nimport { MessageHandler } from \"./handlers\";\r\nimport { BaseMessage, BlockViewModel } from \"./models\";\r\nimport { EventsBus } from './root/events.bus';\r\n\r\nexport class EventsDispatcher {\r\n    handleMessage: (handler: MessageHandler, msg: BaseMessage) => void = () => {};\r\n\r\n    constructor(private factory: HandlersFactory, private messages: MessagesService) {\r\n        EventsBus.Current.subscribe('dnd.swap-blocks', (args, _source) => {\r\n            this.handleMessage(this.factory.get('swap'), args);\r\n            this.swapBlock(args);\r\n            return null;\r\n        });\r\n    }\r\n\r\n    run() {\r\n        window.addEventListener('message', (event: MessageEvent) => {\r\n            if (event.data) {\r\n                this.handleEvent(event.data)\r\n            }\r\n        });\r\n    }\r\n\r\n    selectBlock(vm: BlockViewModel) {\r\n        if (!!vm && vm.source) {\r\n            this.handleEvent({ type: 'select', content: vm.source });\r\n            this.messages.selectBlock(vm.source);\r\n            vm.selected = false;\r\n        } else {\r\n            this.handleEvent({ type: 'select', content: { id: 0 } });\r\n            this.messages.selectBlock(null);\r\n            if (!!vm) {\r\n                vm.selected = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    highlightBlock(vm: BlockViewModel) {\r\n        this.messages.blockHover(vm.source);\r\n    }\r\n\r\n    unlightBlock() {\r\n        this.messages.blockHover({ id: 0 });\r\n    }\r\n\r\n    swapBlock(args: any) {\r\n        this.messages.swapBlocks(args);\r\n    }\r\n\r\n    private handleEvent(msg: BaseMessage) {\r\n        const handler = this.factory.get(msg.type);\r\n        if (handler) {\r\n            this.handleMessage(handler, msg);\r\n        }\r\n    }\r\n}\r\n","import * as handlers from \"./handlers\";\r\n\r\nexport class HandlersFactory {\r\n    private static handlers: handlers.MessageHandler[] = [\r\n        new handlers.AddHandler(),\r\n        new handlers.UpdateHandler(),\r\n        new handlers.CloneHandler(),\r\n        new handlers.HideHandler(),\r\n        new handlers.ShowHandler(),\r\n        new handlers.RemoveHandler(),\r\n        new handlers.PreviewHandler(),\r\n        new handlers.SelectHandler(),\r\n        new handlers.SwapHandler(),\r\n        new handlers.ReloadHandler(),\r\n        new handlers.PageHandler(),\r\n        new handlers.HoverHandler()\r\n    ];\r\n\r\n    get(key: string): handlers.MessageHandler {\r\n        return HandlersFactory.handlers.find(x => x.key == key);\r\n    }\r\n}\r\n","import { ServiceLocator } from './../service-locator';\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\nimport { BaseHandler } from \"./base.handler\";\r\n\r\nexport class AddHandler extends BaseHandler {\r\n    readonly key = 'add';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        this.clearPreview(list);\r\n        list.push(vm);\r\n        vm.selected = true;\r\n        this.reloadBlock(vm.source).then(result => {\r\n            vm.htmlString = result;\r\n            this.renderer.add(vm);\r\n            this.renderer.select(vm);\r\n        });\r\n    }\r\n}\r\n","import { Renderer } from './../renderer';\r\nimport { BaseMessage, MessageContent } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\nimport { MessageHandler } from \"./message.handler\";\r\nimport { ServiceLocator } from '../service-locator';\r\n\r\nexport abstract class BaseHandler implements MessageHandler {\r\n\r\n    abstract readonly key: string;\r\n    protected get renderer(): Renderer {\r\n        return ServiceLocator.getRenderer();\r\n    }\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        let vm = this.getViewModel(msg.content.id, list);\r\n        if (!vm) {\r\n            vm = this.createViewModel(msg.content);\r\n        }\r\n        this.executeInternal(msg, list, vm);\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) { }\r\n\r\n    protected reloadBlock(model: any): Promise<string> {\r\n        return ServiceLocator.getHttp().post(model);\r\n    }\r\n\r\n    protected generateId(id: number) {\r\n        if (id) {\r\n            return `instance${id}`;\r\n        }\r\n        return 'preview-instance';\r\n    }\r\n\r\n    protected createViewModel(content: MessageContent, isPreview = false): BlockViewModel {\r\n        const result = new BlockViewModel();\r\n        Object.assign(result, {\r\n            id: this.generateId(content.id),\r\n            source: content,\r\n            element: null,\r\n            isPreview: isPreview,\r\n            htmlString: null,\r\n            selected: false,\r\n            hidden: !!content.hidden\r\n        });\r\n        return result;\r\n    }\r\n\r\n    protected getViewModel(id: number, list: BlockViewModel[]): BlockViewModel {\r\n        const internalId = this.generateId(id);\r\n        return list.find(x => x.id === internalId);\r\n    }\r\n\r\n    protected deselectAll(list: BlockViewModel[]) {\r\n        list.forEach(x => x.selected = false);\r\n    }\r\n\r\n    protected clearPreview(list: BlockViewModel[]) {\r\n        const listToRemove = list.map((item, index) => <any>{ item, index }).filter(x => x.item.isPreview);\r\n        listToRemove.forEach(x => {\r\n            list.splice(x.index, 1);\r\n            x.item.element.remove();\r\n        });\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class CloneHandler extends BaseHandler {\r\n    readonly key = 'clone';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        const source = this.getViewModel(msg.content.source, list);\r\n\r\n        const model = { ...source.source, id: msg.content.destination };\r\n        const clone = this.createViewModel(model);\r\n        clone.htmlString = source.htmlString;\r\n        clone.hidden = source.hidden;\r\n        clone.selected = true;\r\n\r\n        const index = list.indexOf(source);\r\n        list.splice(index + 1, 0, clone);\r\n        this.renderer.insert(clone, index + 1);\r\n        this.renderer.select(clone);\r\n        setTimeout(() => {\r\n            this.renderer.scrollTo(clone);\r\n        }, 300);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class HideHandler extends BaseHandler {\r\n    readonly key = 'hide';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.hidden = true;\r\n        vm.element.style.display = 'none';\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class HoverHandler extends BaseHandler {\r\n    readonly key = 'hover';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        const content = msg.content;\r\n        if (!content.id) {\r\n            this.renderer.hover();\r\n        } else {\r\n            super.execute(msg, list);\r\n        }\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        this.renderer.hover(vm);\r\n    }\r\n}\r\n","export * from './message.handler';\r\n\r\nexport * from './add.handler';\r\nexport * from './clone.handler';\r\nexport * from './hide.handler';\r\nexport * from './hover.handler';\r\nexport * from './preview.handler';\r\nexport * from './remove.handler';\r\nexport * from './select.handler';\r\nexport * from './show.handler';\r\nexport * from './swap.handler';\r\nexport * from './update.handler';\r\n\r\nexport * from './reload.handler';\r\nexport * from './page.handler';\r\n","import { ServiceLocator } from './../service-locator';\r\nimport { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class PageHandler extends BaseHandler {\r\n    readonly key = 'page';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        console.log(msg);\r\n        const blocks = msg.content.blocks;\r\n        blocks.forEach(x => {\r\n            const vm = this.createViewModel(x);\r\n            list.push(vm);\r\n        });\r\n        Promise.all(list.map(x => {\r\n            const promise = this.reloadBlock(x.source).then(html => {\r\n                x.htmlString = html;\r\n                return html;\r\n            });\r\n            return promise;\r\n        })).then(() => {\r\n            list.forEach(x => {\r\n                this.renderer.add(x);\r\n            });\r\n            // var $: any = window['jQuery'];\r\n            // $(\".carousel-block\").carousel();\r\n            ServiceLocator.getMessages().renderComplete();\r\n        });\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class PreviewHandler extends BaseHandler {\r\n    readonly key = 'preview';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.clearPreview(list);\r\n        if (!!msg.content) {\r\n            const vm = this.createViewModel(msg.content, true);\r\n            list.push(vm);\r\n            this.reloadBlock(vm.source).then(result => {\r\n                vm.htmlString = result;\r\n                this.renderer.add(vm);\r\n                this.renderer.scrollTo(vm);\r\n            });\r\n        }\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class ReloadHandler extends BaseHandler {\r\n    readonly key = 'reload';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        document.location.reload();\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class RemoveHandler extends BaseHandler {\r\n    readonly key = 'remove';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        const index = list.indexOf(vm);\r\n        list.splice(index, 1);\r\n        vm.element.remove();\r\n        this.renderer.select();\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class SelectHandler extends BaseHandler {\r\n    readonly key = 'select';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        this.deselectAll(list);\r\n        this.clearPreview(list);\r\n        const content = msg.content;\r\n        if (content.id === 0) {\r\n            this.renderer.select();\r\n        } else {\r\n            super.execute(msg, list);\r\n        }\r\n    }\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.selected = true;\r\n        this.renderer.select(vm);\r\n        this.renderer.scrollTo(vm);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class ShowHandler extends BaseHandler {\r\n    readonly key = 'show';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.hidden = false;\r\n        vm.element.style.display = 'block';\r\n        this.renderer.scrollTo(vm);\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class SwapHandler extends BaseHandler {\r\n    readonly key = 'swap';\r\n\r\n    execute(msg: BaseMessage, list: BlockViewModel[]) {\r\n        const vm = list[msg.content.currentIndex];\r\n        list.splice(msg.content.currentIndex, 1);\r\n        list.splice(msg.content.newIndex, 0, vm);\r\n        if (list[msg.content.currentIndex].element.parentElement === list[msg.content.newIndex].element.parentElement) {\r\n            vm.element.remove();\r\n            this.renderer.insert(vm, msg.content.newIndex);\r\n        }\r\n    }\r\n}","import { BaseHandler } from \"./base.handler\";\r\nimport { BaseMessage } from \"../models\";\r\nimport { BlockViewModel } from \"../block.view-model\";\r\n\r\nexport class UpdateHandler extends BaseHandler {\r\n    readonly key = 'update';\r\n\r\n    protected executeInternal(msg: BaseMessage, list: BlockViewModel[], vm: BlockViewModel) {\r\n        vm.source = msg.content;\r\n        this.reloadBlock(vm.source).then((result: string) => {\r\n            vm.htmlString = result;\r\n            this.renderer.update(vm);\r\n            this.renderer.select(vm);\r\n            // var $: any = window['jQuery'];\r\n            // $(\".carousel-block\").carousel();\r\n        });\r\n    }\r\n}","export function  measureElement(element): { top?: number, left?: number, height?: number, width?: number } {\r\n    const target = element;\r\n    const target_width = target.offsetWidth;\r\n    const target_height = target.offsetHeight;\r\n    let rect = {};\r\n    let gleft = 0;\r\n    let gtop = 0;\r\n\r\n    var moonwalk = function (_parent) {\r\n        if (!!_parent) {\r\n            gleft += _parent.offsetLeft;\r\n            gtop += _parent.offsetTop;\r\n            moonwalk(_parent.offsetParent);\r\n        } else {\r\n            return rect = {\r\n                top: target.offsetTop + gtop,\r\n                left: target.offsetLeft + gleft,\r\n                height: target_height,\r\n                width: target_width\r\n            };\r\n        }\r\n    };\r\n    moonwalk(target.offsetParent);\r\n    return rect;\r\n}","import { Environment } from './environment';\r\nimport { ServiceLocator } from './service-locator';\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    console.log('run preview window')\r\n    Environment.DesignerUrl = window.location.search.substr(1).split('&').find(q => q.startsWith('ep=')).substr(3);\r\n    const app = ServiceLocator.createApp();\r\n    app.run();\r\n});\r\n\r\nwindow.addEventListener('click', (event) => {\r\n    event.preventDefault();\r\n});\r\n","import { EventsBus } from './root/events.bus';\r\nimport { DndInteractor } from './dnd.interactor';\r\nimport { BlockViewModel } from './models';\r\nimport { ServiceLocator } from './service-locator';\r\nimport { measureElement } from './helpers';\r\n\r\nexport class PreviewInteractor {\r\n    private readonly borderWidth: number = 3;\r\n\r\n    private hoverElement: HTMLElement;\r\n    private selectElement: HTMLElement;\r\n\r\n    private hoveredViewModel: BlockViewModel = null;\r\n    private selectedViewModel: BlockViewModel = null;\r\n\r\n    private inactive = false; // use with dnd\r\n\r\n    constructor(private dnd: DndInteractor) {\r\n        this.createHoverElement();\r\n        this.createSelectElement();\r\n        this.dnd.onDragStarted = () => {\r\n            this.inactive = true;\r\n            this.hideHoverElement();\r\n            this.hideSelectElement();\r\n        };\r\n        this.dnd.onDragFinished = () => {\r\n            this.inactive = false;\r\n        }\r\n    }\r\n\r\n    hover(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        if (vm == null || this.selectedViewModel == vm) {\r\n            this.hideHoverElement();\r\n        } else {\r\n            this.hoveredViewModel = vm;\r\n            this.hoverElement.style.display = 'block';\r\n            this.placeElementHover(vm.element, this.hoverElement);\r\n        }\r\n    }\r\n\r\n    select(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        this.selectedViewModel = vm;\r\n        this.selectElement.style.display = 'block';\r\n        this.placeElementHover(vm.element, this.selectElement);\r\n    }\r\n\r\n    deselect() {\r\n        this.hideSelectElement();\r\n    }\r\n\r\n    scrollTo(vm: BlockViewModel) {\r\n        if (this.inactive) return;\r\n        const rect = measureElement(vm.element);\r\n        const targetPosition = rect.top - window.innerHeight / 10;\r\n        window.scroll({\r\n            top: targetPosition,\r\n            behavior: 'smooth'\r\n        });\r\n    }\r\n\r\n    private hideSelectElement() {\r\n        this.selectedViewModel = null;\r\n        this.selectElement.style.display = 'none';\r\n    }\r\n\r\n    private hideHoverElement() {\r\n        this.hoveredViewModel = null;\r\n        this.hoverElement.style.display = 'none';\r\n    }\r\n\r\n    private createHoverElement(): HTMLElement {\r\n        const result = this.createShadowElement();\r\n        result.style.border = `${this.borderWidth}px dotted #33ada9`;\r\n        result.addEventListener('mouseleave', () => {\r\n            if (this.hoveredViewModel != null) {\r\n                this.hoveredViewModel.onLeave();\r\n            }\r\n            this.hideHoverElement();\r\n        });\r\n        result.addEventListener('click', (event) => {\r\n            this.select(this.hoveredViewModel);\r\n            this.hoveredViewModel.onSelect();\r\n            this.hideHoverElement();\r\n        });\r\n        result.addEventListener('mousedown', (event: MouseEvent) => {\r\n            this.dnd.mouseDown(event, this.hoveredViewModel);\r\n        });\r\n        this.hoverElement = result;\r\n        return result;\r\n    }\r\n\r\n    private createSelectElement(): HTMLElement {\r\n        const result = this.createShadowElement();\r\n        result.style.border = `${this.borderWidth}px solid #33ada9`;\r\n        result.addEventListener('click', (event) => {\r\n            const dispatcher = ServiceLocator.getDispatcher();\r\n            dispatcher.selectBlock(null);\r\n        });\r\n        result.addEventListener('mousedown', (event: MouseEvent) => {\r\n            this.dnd.mouseDown(event, this.selectedViewModel);\r\n        });\r\n        this.selectElement = result;\r\n        return result;\r\n    }\r\n\r\n    private createShadowElement(): HTMLElement {\r\n        const result = document.createElement('div');\r\n        result.style.position = 'absolute';\r\n        result.style.display = 'none';\r\n        result.style.zIndex = '10000';\r\n        document.body.appendChild(result);\r\n        return result;\r\n    }\r\n\r\n    private placeElementHover(source: HTMLElement, target: HTMLElement) {\r\n        if (!source) {\r\n            return;\r\n        }\r\n        const rect = measureElement(source);\r\n        const doubleWidth = this.borderWidth * 2;\r\n        const delta = 0;\r\n        target.style.top = (rect.top + delta) + 'px';\r\n        target.style.left = (rect.left + delta) + 'px';\r\n        target.style.height = (rect.height - 2 * delta) + 'px';\r\n        target.style.width = (rect.width - 2 * delta) + 'px';\r\n        target.style.display = 'block';\r\n    }\r\n}\r\n","import { EventsBus } from './root/events.bus';\r\nimport { ServiceLocator } from './service-locator';\r\nimport { BlockViewModel } from './block.view-model';\r\nimport { PreviewInteractor } from './preview.interactor';\r\nimport { DndInteractor } from './dnd.interactor';\r\n\r\nexport class Renderer {\r\n\r\n    private interactor: PreviewInteractor;\r\n\r\n    constructor(public container: HTMLElement) {\r\n        this.interactor = ServiceLocator.getPreviewInteractor();\r\n    }\r\n\r\n    add(vm: BlockViewModel) {\r\n        vm.element = this.createElement(vm);\r\n        this.container.append(vm.element);\r\n        if (vm.hidden) {\r\n            vm.element.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    update(vm: BlockViewModel) {\r\n        const element = vm.element;\r\n        if (!element) {\r\n            return;\r\n        }\r\n        vm.element = this.createElement(vm);\r\n        this.container.replaceChild(vm.element, element);\r\n        this.interactor.select(vm);\r\n        this.hover(vm);\r\n    }\r\n\r\n    insert(vm: BlockViewModel, index: number) {\r\n        vm.element = this.createElement(vm);\r\n        const beforeElement = this.container.children.item(index);\r\n        this.container.insertBefore(vm.element, beforeElement);\r\n        if (vm.hidden) {\r\n            vm.element.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    select(vm: BlockViewModel = null) {\r\n        if (vm === null || vm.hidden || !vm.selected) {\r\n            this.interactor.deselect();\r\n        } else {\r\n            this.interactor.select(vm)\r\n        }\r\n    }\r\n\r\n    scrollTo(vm: BlockViewModel) {\r\n        if (vm && vm.element && !vm.hidden) {\r\n            this.interactor.scrollTo(vm)\r\n        }\r\n    }\r\n\r\n    hover(vm: BlockViewModel = null) {\r\n        if (vm === null || vm.hidden || vm.selected) {\r\n            this.interactor.hover(null);\r\n        } else {\r\n            this.interactor.hover(vm);\r\n        }\r\n    }\r\n\r\n    private createElement(vm: BlockViewModel) {\r\n        const div = document.createElement('div');\r\n        div.innerHTML = `<div>${vm.htmlString}</div>`;\r\n        const result = <HTMLElement>div.firstChild;\r\n        result.style.userSelect = 'none';\r\n        if (!vm.isPreview) {\r\n            result.addEventListener('mouseover', ($event: MouseEvent) => {\r\n                this.interactor.hover(vm);\r\n                vm.onHover();\r\n            });\r\n            result.addEventListener('click', () => vm.onSelect());\r\n        }\r\n        return result;\r\n    }\r\n}\r\n","export class EventsBus {\r\n\r\n    static Current = new EventsBus();\r\n\r\n    private subscribers = {};\r\n\r\n    publish(type: string, args: any, source: any) {\r\n        if (this.subscribers[type]) {\r\n            this.subscribers[type].forEach(handler => {\r\n                handler(args, source);\r\n            });\r\n        }\r\n    }\r\n\r\n    subscribe(type: string, handler: (args: any, source: any) => {}): () => void {\r\n        if (!this.subscribers[type]) {\r\n            this.subscribers[type] = [];\r\n        }\r\n        this.subscribers[type].push(handler);\r\n        return () => {\r\n            const index = this.subscribers[type].indexOf(handler);\r\n            if (index !== -1) {\r\n                this.subscribers[type].splice(index, 1);\r\n            }\r\n        };\r\n    }\r\n}\r\n","import { DndInteractor } from './dnd.interactor';\r\nimport { PreviewInteractor } from './preview.interactor';\r\nimport { EventsBus } from './root/events.bus';\r\nimport { HttpService } from './services/http.service';\r\nimport { EventsDispatcher } from './events.dispatcher';\r\nimport { Renderer } from './renderer';\r\nimport { HandlersFactory } from './handlers.factory';\r\nimport { Environment } from './environment';\r\nimport { App } from './app';\r\nimport { MessagesService } from './services/messages.service';\r\n\r\nexport class ServiceLocator {\r\n\r\n    private static _app;\r\n    private static _container;\r\n    private static _http;\r\n    private static _messages;\r\n    private static _renderer;\r\n    private static _factory;\r\n    private static _dispatcher;\r\n    private static _eventBus;\r\n    private static _interactor;\r\n    private static _dnd;\r\n\r\n    static createApp(): App {\r\n        this._container = document.getElementById(\"designer-preview\");\r\n        return this._app || (this._app = new App(this.getDispatcher()));\r\n    }\r\n\r\n    static getPreviewInteractor(): PreviewInteractor {\r\n        if (!this._interactor) {\r\n            this._interactor = new PreviewInteractor(this.getDndInteractor());\r\n        }\r\n        return this._interactor;\r\n    }\r\n\r\n    static getDndInteractor(): DndInteractor {\r\n        return this._dnd || (this._dnd = new DndInteractor(this._container, () => this._app.getList()));\r\n    }\r\n\r\n    static getEventBus(): EventsBus {\r\n        return this._eventBus || (this._eventBus = new EventsBus());\r\n    }\r\n\r\n    static getHttp(): HttpService {\r\n        return this._http || (this._http = new HttpService(Environment.RenderBlockApiUrl));\r\n    }\r\n\r\n    static getMessages(): MessagesService {\r\n        return this._messages || (this._messages = new MessagesService(Environment.DesignerUrl));\r\n    }\r\n\r\n    static getRenderer(): Renderer {\r\n        return this._renderer || (this._renderer = new Renderer(this._container));\r\n    }\r\n\r\n    static getFactory(): HandlersFactory {\r\n        return this._factory || (this._factory = new HandlersFactory());\r\n    }\r\n\r\n    static getDispatcher(): EventsDispatcher {\r\n        return this._dispatcher || (this._dispatcher = new EventsDispatcher(this.getFactory(), this.getMessages()));\r\n    }\r\n}","export class HttpService {\r\n\r\n    private token: string;\r\n\r\n    constructor(private endpoint: string) { }\r\n\r\n    get() {\r\n\r\n    }\r\n\r\n    postTo(endpoint: string, model: any) {\r\n        // https://gist.github.com/codecorsair/e14ec90cee91fa8f56054afaa0a39f13\r\n        return new Promise<string>((resolve, reject) => {\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.open('post', endpoint);\r\n\r\n            xhr.setRequestHeader('Accept', 'application/json, text/javascript, text/plain')\r\n            xhr.setRequestHeader('Cache-Control', 'no-cache');\r\n            xhr.setRequestHeader('Content-Type', 'application/json');\r\n            xhr.setRequestHeader('X-XSRF-TOKEN', this.getToken());\r\n            xhr.send(JSON.stringify(model));\r\n            // xhr.timeout = timeout;\r\n            xhr.onload = evt => {\r\n                // const result = {\r\n                //     ok: xhr.status >= 200 && xhr.status < 300,\r\n                //     status: xhr.status,\r\n                //     statusText: xhr.statusText,\r\n                //     headers: xhr.getAllResponseHeaders(),\r\n                //     data: xhr.responseText\r\n                // };\r\n                resolve(xhr.responseText.trim());\r\n                // this.blocks.push(model); or replace\r\n            };\r\n            // xhr.onerror = evt => {\r\n            //   resolve(errorResponse(xhr, 'Failed to make request.'));\r\n            // };\r\n            // xhr.ontimeout = evt => {\r\n            //   resolve(errorResponse(xhr, 'Request took longer than expected.'));\r\n            // };\r\n        });\r\n    }\r\n\r\n    post(model: any): Promise<string> {\r\n        return this.postTo(this.endpoint, model);\r\n    }\r\n\r\n    private getToken(): string {\r\n        if (!this.token){\r\n            var all = document.cookie;\r\n            var parts = all.split(';');\r\n            var xsrf = null;\r\n            for (var i = 0; i < parts.length; i++) {\r\n                var part = parts[i];\r\n                if (part.startsWith(' XSRF-TOKEN') || part.startsWith('XSRF-TOKEN')){\r\n                    xsrf = part.substr(part.indexOf('XSRF-TOKEN=') + 11)\r\n                    break;\r\n                }\r\n            }\r\n            this.token = xsrf;\r\n        }\r\n        return this.token;\r\n    }\r\n\r\n/*\r\n\r\n\r\n\r\n\r\n*/\r\n\r\n\r\n\r\n\r\n}","import { MessageContent } from '../models';\r\n\r\nexport class MessagesService {\r\n\r\n    constructor(private parentOrigin: string) { }\r\n\r\n    renderComplete() {\r\n        this.send('render-complete', null);\r\n    }\r\n\r\n    blockHover(model) {\r\n        this.send('hover', { id: model.id });\r\n    }\r\n\r\n    swapBlocks(args) {\r\n        this.send('swap', { type: 'swap', ...args });\r\n    }\r\n\r\n    selectBlock(model: MessageContent) {\r\n        this.send('select', model ? { id: model.id } : null);\r\n    }\r\n\r\n    ping() {\r\n        this.send('ping', null);\r\n    }\r\n\r\n    private send(message: string, model) {\r\n        const msg = { type: message, ...model };\r\n        console.log('send to designer', msg);\r\n        window.parent.postMessage(msg, this.parentOrigin);\r\n    }\r\n}"],"sourceRoot":""}